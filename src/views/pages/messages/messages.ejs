<%- include ('../../partials/head') %>
  <%- include ('../../partials/menu') %>
    <div class="col"><%- include ('../../partials/message') %></div>

    <main>
        <div class="container">
            <div class="row">
              </div>
              <centre>
                <div class="col-md-10" style="padding-top: 20px;"> 
                    <div class="card w-200">
                      <div class="card-body">  
                        <!-- <img src="/images/messenger.png" alt="history_icon" style="display:inline; width: 35px; padding-right: 10px;"> -->
                        <h4 class="card-title" style="display:inline">Messages</h4>
                      </div>
                      <div class="row">
                        <div class="col-md-2" style="padding-left:30px;">
                          <label>Search User:</label>
                        </div>
                        <div class="col" style="float: left; padding-bottom: 10px; padding-right:25px">
                          <form method="POST">
                            <input type="text" id="username" name="username" placeholder="Username">
                            <button type="submit" class="btn btn-outline-dark btn-sm" style="float: right;">Search</button>
                          </form>
                        </div>
                        
                      </div>
            
                    
                      <ul class="list-group list-group-flush">
                        <% 
                            if (messages) {
                                messages.forEach(function(message) { %> 
                                   <% if (message[0].sender_id == user.user_id) { %>
                                        <li class="list-group-item"><%- message[0].receiver_data.username %>
                                    <% } else { %>
                                        <li class="list-group-item"><%- message[0].sender_data.username %>
                                    <% } %>
                                    <form action="/message/messages/discuss" method="POST">
                                        <input type="hidden" id="message_data" name="message_data" value="<%= JSON.stringify(message) %>">
                                        <button type="submit" class="btn btn-outline-dark btn-sm" style="float: right;">
                                            Chat
                                        </button>
                                        
                                    </form>
                                    </li>
                            <% }) } %>
                      </ul>
                    </div>  
                  </div>
              </centre>
              
              
        </div>
    </main>